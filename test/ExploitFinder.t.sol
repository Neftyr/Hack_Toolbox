// SPDX-License-Identifier: MIT

pragma solidity ^0.8.19;

import {StdCheats} from "forge-std/StdCheats.sol";
import {Test, console} from "forge-std/Test.sol";
import {Vm} from "forge-std/Vm.sol";

contract ExploitFinder is StdCheats, Test {
    address private constant TARGET = 0x5Cbd7Feb522f3060985Ddb07929eB7ee12568a48;
    address private constant HUNTED = 0xe5760847db2f10A74Fc575B4803df5fe129811C1;
    address private constant HACKER = 0x50e2a33B9E04e78bF1F1d1F94b0be95Be63C23e7;

    uint256 deployerKey = vm.envUint("PRIVATE_KEY");

    function setUp() external {}

    function isUint128(uint256 num) public pure returns (bool) {
        uint128 maxValue = 2 ** 128 - 1;
        return num <= maxValue;
    }

    function isUint256(uint256 number) public pure returns (bool) {
        if (type(uint256).max >= number) {
            return true;
        } else {
            return false;
        }
    }

    function testFindNumber(uint128 randomNumber) external {
        vm.startPrank(HUNTED);

        (bool success, ) = TARGET.call(abi.encodeWithSignature("hellFunc(uint128)", randomNumber));

        if (success) {
            console.log("Number Not Found...");
        } else {
            console.log("Number Found!: ", randomNumber);
        }

        vm.stopPrank();
    }
}
